/**
 * Created by Marvin on 2018/1/22.
 */
const resolveAssetSource = require('react-native/Libraries/Image/resolveAssetSource');
const OriginalReactNative = require('react-native');
const processColor = OriginalReactNative.processColor;

export default class ProcessManager {

    /**
     * 处理JSColors、JSIcon方便原生转换
     * @param property
     */
    static processJSColorsAndJSIcon(property){
        let allKeys = Object.keys(property);
        allKeys.forEach( (propertyKey) => {
            if (property.hasOwnProperty(propertyKey)) {
                if (propertyKey === 'icon' || propertyKey.endsWith('Icon') || propertyKey.endsWith('Image')) {
                    property[propertyKey] = resolveAssetSource(property[propertyKey]);
                }
                if (propertyKey === 'color' || propertyKey.endsWith('Color')) {
                    property[propertyKey] = __IOS__ ? processColor(property[propertyKey]) : property[propertyKey];
                }
            }
        });
    }

    /**
     * 处理tabConfigs
     * @param tabConfigs
     */
    static processTabConfigs(tabConfigs){
        if (tabConfigs) {
            // 处理tabConfigs的图片和color参数转换
            this.processJSColorsAndJSIcon(tabConfigs);
            // 处理pages数组里的图片和color的参数转换
            let tabConfigsPages = tabConfigs.pages;
            if (tabConfigsPages && Array.isArray(tabConfigsPages)) {
                tabConfigsPages.forEach((tabConfigPage) => {
                    this.processJSColorsAndJSIcon(tabConfigPage);
                })
            }
        }
    }


}